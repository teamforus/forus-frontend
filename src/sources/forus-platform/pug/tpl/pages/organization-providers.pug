.app.app-container
    menu
    section.app.app-content(ng-if="$ctrl.loaded")
        .card-heading(ng-if="$ctrl.funds.length > 1" translate="organization_providers.header.title")
        
        .block.block-choose-organization(ng-if="$ctrl.funds.length > 1")
            div(
                ng-repeat="fund in $ctrl.fund ? [$ctrl.fund] : $ctrl.funds" 
                ui-sref="organization-providers({organization_id: fund.organization_id, fund_id: fund.id})").organization-item
                .organization-item-inner
                    .organization-logo: img(ng-src="{{ fund.logo.sizes.thumbnail || './assets/img/placeholders/fund-thumbnail.png' }}")
                    .organization-name(ng-bind="fund.name")

            div(
                ng-if="$ctrl.fund && $ctrl.funds.length > 1"
                ui-sref="organization-providers({organziation_id: fund.organization_id, fund_id: null})").organization-item
                .organization-item-inner
                    .organization-logo.organization-logo-mdi: .mdi.mdi-chevron-up
                    .organization-name(ng-bind="'csv_validation.buttons.choose' | translate")
        
        div(ng-if="$ctrl.fund")
            .card-heading: .row
                .col.col-lg-6.col-xs-12
                    span(translate="organization_providers.header.title")
                    span(ng-bind="$ctrl.fundProviders.meta.total").span-count
                .block.block-inline-filters.col.col-lg-6.col-xs-12
                    .button.button-text(ng-if="$ctrl.filters.show" ng-click="$ctrl.resetFilters()")
                        em.mdi.mdi-close.icon-start
                        span(i18n="Wis filters")

                    .form(ng-if="!$ctrl.filters.show")
                        .form-group.inline-filters-search: input(
                            ng-model="$ctrl.filters.values.q" 
                            type="text" 
                            placeholder="{{ 'search' | i18n }}").form-control

                    .inline-filters-dropdown(click-outside="$ctrl.hideFilters()")
                        .inline-filters-dropdown-content(ng-show="$ctrl.filters.show")
                            .arrow-box.bg-dim: .arrow
                            .form
                                .form-group
                                    form-label-toggle(label="{{ 'search' | i18n }}" is-active)
                                    .inline-filters-pane
                                        input(ng-model="$ctrl.filters.values.q" type="text" placeholder="{{ 'search' | i18n }}").form-control
                                        .checkbox
                                            input(
                                                value="1"
                                                type="checkbox" 
                                                id="show_dismissed"
                                                ng-model="$ctrl.filters.values.dismissed")
                                            label(for="show_dismissed").checkbox-label
                                                .checkbox-box: .mdi.mdi-check
                                                | Toon verborgen aanbieders
                                
                                .form-group
                                    form-label-toggle(label="Accepteer budget")
                                    .inline-filters-pane
                                        .radio
                                            input#allow_budget_yes(
                                                type="radio" 
                                                name="allow_budget" 
                                                ng-model="$ctrl.filters.values.allow_budget" value="1")
                                            label(for="allow_budget_yes").radio-label
                                                .radio-circle
                                                | Ja
                                        .radio
                                            input#allow_budget_no(
                                                type="radio" 
                                                name="allow_budget" 
                                                ng-model="$ctrl.filters.values.allow_budget" value="0")
                                            label(for="allow_budget_no").radio-label
                                                .radio-circle
                                                | Nee
                                        .radio
                                            input#allow_budget_all(
                                                type="radio" 
                                                name="allow_budget" 
                                                ng-model="$ctrl.filters.values.allow_budget" value="")
                                            label(for="allow_budget_all").radio-label
                                                .radio-circle
                                                | Alle
                                
                                .form-group
                                    form-label-toggle(label="Accepteer aanbiedingen")
                                    .inline-filters-pane
                                        .radio
                                            input#allow_products_yes(
                                                type="radio" 
                                                name="allow_products" 
                                                ng-model="$ctrl.filters.values.allow_products" value="1")
                                            label(for="allow_products_yes").radio-label
                                                .radio-circle
                                                | Alle aanbiedingen
                                        .radio
                                            input#allow_products_some(
                                                type="radio" 
                                                name="allow_products" 
                                                ng-model="$ctrl.filters.values.allow_products" value="some")
                                            label(for="allow_products_some").radio-label
                                                .radio-circle
                                                | Sommige aanbiedingen
                                        .radio
                                            input#allow_products_no(
                                                type="radio" 
                                                name="allow_products" 
                                                ng-model="$ctrl.filters.values.allow_products" value="0")
                                            label(for="allow_products_no").radio-label
                                                .radio-circle
                                                | Geen aanbiedingen
                                        .radio
                                            input#allow_products_all(
                                                type="radio" 
                                                name="allow_products" 
                                                ng-model="$ctrl.filters.values.allow_products" value="")
                                            label(for="allow_products_all").radio-label
                                                .radio-circle
                                                | Alle
                        .button.button-default.button-icon(ng-click="$ctrl.filters.show = !$ctrl.filters.show"): em.mdi.mdi-filter-outline

            .card(ng-repeat="providerFund in $ctrl.fundProviders.data")
                .card-section
                    .card-section-actions
                        button(
                            ng-if="!providerFund.dismissed && !providerFund.allow_budget && !providerFund.allow_products" 
                            ng-click="$ctrl.dismissProvider(providerFund)").button.button-default
                            | Verberg
                            em.mdi.mdi-close.icon-end
                        .button.button-text.button-text.button-text-muted.button-narrow(
                            ng-if="providerFund.dismissed"
                            disabled)
                            | Verborgen

                    .card-block.card-block-provider
                        .provider-img: img(ng-src="{{ providerFund.organization.logo.sizes.thumbnail || './assets/img/placeholders/organization-thumbnail.png' }}")
                        .provider-details
                            .provider-title(ng-bind="providerFund.organization.name")
                            .row: .col.col-lg-10: .flex-row
                                .flex-col: .card-block.card-block-listing.card-block-listing-inline.card-block-listing-variant(
                                    ng-if="providerFund.organization.email")
                                    .card-block-listing-label(translate="organization_providers.labels.mail")
                                    .card-block-listing-value.text-primary-light(ng-bind="providerFund.organization.email")
                                .flex-col: .card-block.card-block-listing.card-block-listing-inline.card-block-listing-variant(
                                    ng-if="providerFund.organization.phone")
                                    .card-block-listing-label(translate="organization_providers.labels.phone")
                                    .card-block-listing-value.text-primary-light(ng-bind="providerFund.organization.phone")
                                .flex-col: .card-block.card-block-listing.card-block-listing-inline.card-block-listing-variant(
                                    ng-if="providerFund.organization.business_type.name")
                                    .card-block-listing-label(translate="organization_providers.labels.business_type")
                                    .card-block-listing-value.text-primary-light(ng-bind="providerFund.organization.business_type.name")
                                .flex-col: .card-block.card-block-listing.card-block-listing-inline.card-block-listing-variant(
                                    ng-if="providerFund.organization.kvk")
                                    .card-block-listing-label(translate="organization_providers.labels.kvk")
                                    .card-block-listing-value.text-primary-light(ng-bind="providerFund.organization.kvk")
                            .row: .col.col-lg-8: .flex-row
                                .flex-col: .card-block.card-block-listing.card-block-listing-inline.card-block-listing-variant(
                                    ng-if="providerFund.organization.website")
                                    .card-block-listing-label(translate="organization_providers.labels.website")
                                    .card-block-listing-value.text-primary-light(ng-bind="providerFund.organization.website")

                .card-section.card-section-primary.card-section-narrow: .card-block.card-block-provider.form
                    .provider-offset &nbsp;
                    .provider-details: .row: .col.col-lg-12: .flex-row
                        .flex-col: .card-block.card-block-listing.card-block-listing-inline.card-block-listing-variant
                            .card-block-listing-label(ng-bind="providerFund.products_count_all + ' aanbiedingen'")
                            button(type="button" ui-sref="fund-provider(providerFund.uiViewParams)").button.button-default.button-flat
                                em.mdi.mdi-eye-outline.icon-start
                                | {{ 'organization_providers.buttons.view_request' | translate }}

                        .flex-col: .card-block.card-block-listing.card-block-listing-inline.card-block-listing-variant
                            .card-block-listing-label(translate="organization_providers.labels.accept_budget")
                            .button.button-text: label(for="option_{{ providerFund.id }}_allow_budget").form-toggle
                                input(
                                    type="checkbox" 
                                    id="option_{{ providerFund.id }}_allow_budget"
                                    ng-checked="providerFund.allow_budget"
                                    ng-change="$ctrl.updateAllowBudget(providerFund)"
                                    ng-model="providerFund.allow_budget")
                                .form-toggle-inner.flex-end: .toggle-input: .toggle-input-dot
                            
                        .flex-col: .card-block.card-block-listing.card-block-listing-inline.card-block-listing-variant
                            .card-block-listing-label(translate="organization_providers.labels.accept_all_offers")
                            .button.button-text: label(for="option_{{ providerFund.id }}_allow_products").form-toggle
                                input(
                                    type="checkbox" 
                                    id="option_{{ providerFund.id }}_allow_products" 
                                    ng-checked="providerFund.allow_products" 
                                    ng-change="$ctrl.updateAllowProducts(providerFund)"
                                    ng-model="providerFund.allow_products")
                                .form-toggle-inner.flex-end: .toggle-input: .toggle-input-dot
                        .flex-col: .card-block.card-block-listing.card-block-listing-inline.card-block-listing-variant.pull-right
                            .card-block-listing-label &nbsp;
                            button(
                                ng-if="!providerFund.allow_budget || !providerFund.allow_products"
                                ng-click="$ctrl.updateAllowAll(providerFund)").button.button-primary.button-flat
                                | Accepteer alles

            .card
                .card-section(ng-if="$ctrl.fundProviders.meta" ng-show="$ctrl.fundProviders.meta.last_page > 1")
                    paginator(meta="$ctrl.fundProviders.meta" filters="$ctrl.filters.values" count-buttons="5" on-page-change="onPageChange(query)")

                .card-section(ng-show="$ctrl.fundProviders.meta.total > 0"): .table-pagination.text-right
                    button(ng-click="$ctrl.exportList()").button.button-primary
                        em.mdi.mdi-download.icon-start 
                        span(i18n="transactions.buttons.export")

            block-empty( 
                ng-if="$ctrl.fundProviders.data.length == 0"
                text="Je hebt nog geen verzoeken van aanbieders")
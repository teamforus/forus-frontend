.app.app-container
    menu
    section.app.app-content
        .card-heading: .row
            .col.col-lg-6.col-xs-12
                span(translate="organization_providers.header.title")
                span(ng-bind="$ctrl.providerOrganizations.meta.total").span-count
            
            .block.block-inline-filters.col.col-lg-6.col-xs-12
                .button.button-text(ng-if="$ctrl.filters.show" ng-click="$ctrl.resetFilters()")
                    em.mdi.mdi-close.icon-start
                    span(i18n="Wis filters")

                .button.button-default.button-icon(ng-if="!$ctrl.extendedView" ng-click="$ctrl.setExtendedView(true)"): em.mdi.mdi-format-list-bulleted
                .button.button-default.button-icon(ng-if="$ctrl.extendedView" ng-click="$ctrl.setExtendedView(false)"): em.mdi.mdi-format-list-bulleted-square
                
                .form(ng-if="!$ctrl.filters.show")
                    .form-group.inline-filters-search
                        input(ng-model="$ctrl.filters.values.q" placeholder="{{ 'search' | i18n }}").form-control

                .inline-filters-dropdown(click-outside="$ctrl.hideFilters()")
                    .inline-filters-dropdown-content(ng-show="$ctrl.filters.show")
                        .arrow-box.bg-dim: .arrow
                        .form
                            .form-group
                                form-label-toggle(label="Fund")
                                select(
                                    ng-options="fund.id as fund.name for fund in $ctrl.funds" 
                                    ng-model="$ctrl.filters.values.fund_id").form-control

                            .form-group
                                form-label-toggle(label="Accepteer budget")
                                .inline-filters-pane
                                    .radio
                                        input#allow_budget_yes(
                                            type="radio" 
                                            name="allow_budget" 
                                            ng-model="$ctrl.filters.values.allow_budget" value="1")
                                        label(for="allow_budget_yes").radio-label
                                            .radio-circle
                                            | Ja
                                    .radio
                                        input#allow_budget_no(
                                            type="radio" 
                                            name="allow_budget" 
                                            ng-model="$ctrl.filters.values.allow_budget" value="0")
                                        label(for="allow_budget_no").radio-label
                                            .radio-circle
                                            | Nee
                                    .radio
                                        input#allow_budget_all(
                                            type="radio" 
                                            name="allow_budget" 
                                            ng-model="$ctrl.filters.values.allow_budget" value="")
                                        label(for="allow_budget_all").radio-label
                                            .radio-circle
                                            | Alle
                            
                            .form-group
                                form-label-toggle(label="Accepteer aanbiedingen")
                                .inline-filters-pane
                                    .radio
                                        input#allow_products_yes(
                                            type="radio" 
                                            name="allow_products" 
                                            ng-model="$ctrl.filters.values.allow_products" value="1")
                                        label(for="allow_products_yes").radio-label
                                            .radio-circle
                                            | Alle aanbiedingen
                                    .radio
                                        input#allow_products_some(
                                            type="radio" 
                                            name="allow_products" 
                                            ng-model="$ctrl.filters.values.allow_products" value="some")
                                        label(for="allow_products_some").radio-label
                                            .radio-circle
                                            | Sommige aanbiedingen
                                    .radio
                                        input#allow_products_no(
                                            type="radio" 
                                            name="allow_products" 
                                            ng-model="$ctrl.filters.values.allow_products" value="0")
                                        label(for="allow_products_no").radio-label
                                            .radio-circle
                                            | Geen aanbiedingen
                                    .radio
                                        input#allow_products_all(
                                            type="radio" 
                                            name="allow_products" 
                                            ng-model="$ctrl.filters.values.allow_products" value="")
                                        label(for="allow_products_all").radio-label
                                            .radio-circle
                                            | Alle
                    .button.button-default.button-icon(ng-click="$ctrl.filters.show = !$ctrl.filters.show"): em.mdi.mdi-filter-outline

        .block.block-providers
            .provider-item(ng-repeat="providerOrganization in $ctrl.providerOrganizations.data")
                .provider-media: img.provider-media-img(ng-src="{{ providerOrganization.logo.sizes.thumbnail || './assets/img/placeholders/organization-thumbnail.png' }}")
                .provider-details
                    .provider-title(ng-bind="providerOrganization.name")
                    .provider-subtitle
                        span {{ providerOrganization.products_count }} aanbiedingen
                        span.provider-activity(ng-if="providerOrganization.last_activity") 
                            | Laatst actief: 
                            strong.text-primary {{ providerOrganization.last_activity_locale }}
                        span.provider-activity(ng-if="providerOrganization.last_activity") 
                            | Geaccepteerd voor: 
                            strong.text-primary {{ providerOrganization.funds_active }} fondsen
                    .provider-funds(ng-if="$ctrl.extendedView")
                        .provider-fund(ng-repeat="fund in providerOrganization.funds" ng-class="{active: fund.active}" ng-bind="fund.name")

                    //- TODO: relevant information???
                    //- budget fund: count products
                        .provider-subtitle(ng-if="providerOrganization.fund.type == 'budget'")
                            span {{ providerOrganization.products_count }} aanbiedingen
                            span.provider-activity(ng-if="providerOrganization.last_activity") Laatst actief: {{ providerOrganization.last_activity_locale }}
                    //- subsidy fund: count products approved
                        .provider-subtitle(ng-if="providerOrganization.fund.type == 'subsidies'") 
                            | Actieve acties 
                            .tag.tag-sm(
                                class=(products == 0 ? 'tag-danger' : 'tag-default')
                                ng-bind="providerOrganization.products_count_approved + '/' + providerOrganization.products_count_available")
                            span.provider-activity(ng-if="providerOrganization.last_activity") Laatst actief: {{ providerOrganization.last_activity_locale }}

                .provider-actions.form
                    //- budget fund: allow budget vouchers
                        .provider-action-item(ng-if="providerOrganization.fund.type == 'budget'")
                            label.form-label(translate="organization_providers.labels.accept_budget")
                            label(for="option_{{ providerOrganization.id }}_allow_budget").form-toggle
                                input(
                                    type="checkbox" 
                                    id="option_{{ providerOrganization.id }}_allow_budget"
                                    ng-checked="providerOrganization.allow_budget"
                                    ng-change="$ctrl.updateAllowBudget(providerOrganization)"
                                    ng-model="providerOrganization.allow_budget")
                                .form-toggle-inner.flex-end: .toggle-input: .toggle-input-dot
                        
                    //- budget fund: allow product vouchers
                        .provider-action-item(ng-if="providerOrganization.fund.type == 'budget'")
                            label.form-label(translate="organization_providers.labels.accept_all_offers")
                            label(for="option_{{ providerOrganization.id }}_allow_products").form-toggle
                                input(
                                    type="checkbox" 
                                    id="option_{{ providerOrganization.id }}_allow_products" 
                                    ng-checked="providerOrganization.allow_products" 
                                    ng-change="$ctrl.updateAllowProducts(providerOrganization)"
                                    ng-model="providerOrganization.allow_products")
                                .form-toggle-inner.flex-end: .toggle-input: .toggle-input-dot

                    //- details page
                    .provider-action-item: a(ui-sref="sponsor-provider-organization(providerOrganization.uiViewParams)").button.button-default 
                        em.mdi.mdi-eye-outline.icon-start
                        | Bekijken

        .card
            .card-section(ng-if="$ctrl.providerOrganizations.meta" ng-show="$ctrl.providerOrganizations.meta.last_page > 0")
                paginator(meta="$ctrl.providerOrganizations.meta" filters="$ctrl.filters.values" count-buttons="5" on-page-change="$ctrl.onPageChange(query)")

            .card-section(ng-show="$ctrl.providerOrganizations.meta.total > 0"): .table-pagination.text-right
                button(ng-click="$ctrl.exportList()").button.button-primary
                    em.mdi.mdi-download.icon-start 
                    span(i18n="transactions.buttons.export")

        block-empty( 
            ng-if="$ctrl.providerOrganizations.data.length == 0"
            text="Je hebt nog geen verzoeken van aanbieders")

.app.app-container
    menu
    section.app.app-content
        .block.block-breadcrumbs
            .breadcrumb-item(
                ui-sref="sponsor-provider-organizations({organization_id: $ctrl.organization.id})" 
                translate="page_state_titles.organization-providers")
            .breadcrumb-item(
                ui-sref="sponsor-provider-organization({organization_id: $ctrl.organization.id, provider_organization_id:$ctrl.fundProvider.organization.id})" 
                ng-bind="$ctrl.fundProvider.organization.name")
            .breadcrumb-item.active(
                ng-bind="$ctrl.fundProvider.fund.name")

        block-provider-organization-overview(
            organization="$ctrl.fundProvider.organization" 
            fund-provider="$ctrl.fundProvider" 
            update-fund-provider-allow="$ctrl.updateFundProviderAllow")

        //- Products for subsidy fund (managed by sponsor)
        .card(ng-if="$ctrl.organization.manage_provider_products && $ctrl.fundProvider.fund.type == 'subsidies'")
            .card-header: .row
                .col-lg-8.flex
                    .card-title Aanbod in beheer van {{ $ctrl.organization.name }}
                    a(ui-sref="fund-provider-product-create($ctrl.stateParams)").button.button-text.button-text.button-text-muted 
                        em.mdi.mdi-plus-circle.icon-start
                        | Voeg een aanbod toe
                .col-lg-4: .card-header-drown: .block.block-inline-filters: .form: .form-group: input(
                    ng-model="$ctrl.filtersSponsorProducts.values.q"
                    placeholder="Zoeken").form-control
            
            .card-section.card-section-padless: .table-wrapper: table.table
                tr
                    th.td-narrow Afbeelding
                    th Naam
                    th Aantal
                    th Bijdrage
                    th Prijs
                    th
                
                tr(ng-repeat="product in $ctrl.sponsorProducts.data")
                    td.td-narrow: img(ng-src="{{ product.photo ? product.photo.sizes.small : './assets/img/placeholders/product-small.png' }}").td-media
                    td(ng-bind="product.name")
                    td(ng-if="product.unlimited_stock") Ongelimiteerd
                    td(ng-if="!product.unlimited_stock" ng-bind="product.stock_amount")
                    td(ng-bind="product.active_deal ? (product.active_deal.amount | currency_format) : '-'")
                    td(ng-bind="product.price_locale")
                    td.td-narrow.text-right: .button-group.flex-end
                        .flex.flex-center(ng-if="product.is_available && product.allowed"): .flex-self-center
                            .tag.tag-success.nowrap.flex
                                | Actie actief 
                                .mdi.mdi-close.icon-end(ng-click="$ctrl.disableProductItem($ctrl.fundProvider, product)")
                            .hidden
                        .flex.flex-center(ng-if="!product.is_available"): .flex-self-center
                            .tag.tag-text.nowrap Niet beschikbaar 
                            .hidden
                        button.button.button-primary.button-sm.nowrap(
                            ng-if="product.is_available && !product.allowed" 
                            ng-click="$ctrl.openSubsidyProductModal($ctrl.fundProvider, product)")
                            em.mdi.mdi-play.icon-start
                            | Start actie
                        a(ui-sref="fund-provider-product-create(product.copyParams)").button.button-icon.button-text: em.mdi.mdi-content-copy
                        a(ui-sref="fund-provider-product-edit(product.editParams)").button.button-default.button-sm.button-icon: em.mdi.mdi-pencil
                        button(ng-click="$ctrl.openProductDetails(product)").button.button-default.button-sm.button-icon: em.mdi.mdi-eye-outline

            .card-section.text-center(ng-if="$ctrl.sponsorProducts.meta.total == 0") Geen aanbiedingen
            .card-section.card-section-narrow(ng-if="$ctrl.sponsorProducts.meta" ng-show="$ctrl.sponsorProducts.meta.last_page > 1")
                paginator(
                    meta="$ctrl.sponsorProducts.meta" 
                    filters="$ctrl.filtersSponsorProducts.values" 
                    on-page-change="$ctrl.onPageChangeSponsorProducts(query)")

        //- Products for budget fund (managed by sponsor)
        .card(ng-if="$ctrl.organization.manage_provider_products && $ctrl.fundProvider.fund.type == 'budget'")
            .card-header: .row
                .col-lg-8.flex
                    .card-title Aanbod in beheer van {{ $ctrl.organization.name }}
                    a(ui-sref="fund-provider-product-create($ctrl.stateParams)").button.button-text.button-text.button-text-muted 
                        em.mdi.mdi-plus-circle.icon-start
                        | Voeg een aanbod toe
                .col-lg-4: .card-header-drown: .block.block-inline-filters: .form: .form-group: input(
                    ng-model="$ctrl.filtersSponsorProducts.values.q"
                    placeholder="Zoeken").form-control

            .card-section.card-section-success.card-section-narrow(
                ng-if="$ctrl.fundProvider.allow_products && $ctrl.sponsorProducts.meta.total > 0"): em
                | U kunt niet individuele producten uitzetten terwijl een globale instelling aan staat. 
                | Zet de globale instelling uit om individuele producten goed te keuren.
            
            .card-section.card-section-padless: .table-wrapper: table.table
                tr
                    th.td-narrow Afbeelding
                    th Naam
                    th Aantal
                    th Prijs
                    th Geaccepteerd
                    th
                
                tr(ng-repeat="product in $ctrl.sponsorProducts.data")
                    td.td-narrow: img(
                        ng-src="{{ product.photo ? product.photo.sizes.small : './assets/img/placeholders/product-small.png' }}").td-media
                    td(ng-bind="product.name")
                    td(ng-if="product.unlimited_stock") Ongelimiteerd
                    td(ng-if="!product.unlimited_stock" ng-bind="product.stock_amount")
                    td(ng-bind="product.price_locale")
                    
                    td.td-narrow: .form.pull-right: label(
                        for=("product_{{ product.id }}_enabled") 
                        ng-class="$ctrl.fundProvider.allow_products ? 'form-toggle-disabled form-toggle-active' : ''").form-toggle
                        input(
                            type="checkbox" 
                            id=("product_{{ product.id }}_enabled") 
                            ng-model="product.allowed"
                            ng-change="$ctrl.updateAllowBudgetItem($ctrl.fundProvider, product)")
                        .form-toggle-inner: .toggle-input: .toggle-input-dot

                    td.td-narrow.text-right: .button-group.flex-end
                        a(ui-sref="fund-provider-product-create(product.copyParams)").button.button-icon.button-text: em.mdi.mdi-content-copy
                        a(ui-sref="fund-provider-product-edit(product.editParams)").button.button-default.button-sm.button-icon: em.mdi.mdi-pencil
                        button(ng-click="$ctrl.openProductDetails(product)").button.button-default.button-sm.button-icon: em.mdi.mdi-eye-outline

            .card-section.text-center(ng-if="$ctrl.sponsorProducts.meta.total == 0") Geen aanbiedingen
            .card-section.card-section-narrow(ng-if="$ctrl.sponsorProducts.meta" ng-show="$ctrl.sponsorProducts.meta.last_page > 1")
                paginator(
                    meta="$ctrl.sponsorProducts.meta" 
                    filters="$ctrl.filtersSponsorProducts.values" 
                    on-page-change="$ctrl.onPageChangeSponsorProducts(query)")
        
        //- Products for budget fund
        .card(ng-if="$ctrl.fundProvider.fund.type == 'budget'")
            .card-header: .flex-row
                .flex-col: .card-title Aanbiedingen
                .flex-col: .card-header-drown: .block.block-inline-filters
                    .form(ng-if="!$ctrl.filters.show"): .form-group: input(
                        ng-model="$ctrl.filters.values.q"
                        placeholder="Zoeken").form-control

            .card-section.card-section-success.card-section-narrow(
                ng-if="$ctrl.fundProvider.allow_products && $ctrl.products.meta.total > 0"): em
                | U kunt niet individuele producten uitzetten terwijl een globale instelling aan staat. 
                | Zet de globale instelling uit om individuele producten goed te keuren.
            
            .card-section.card-section-padless: .table-wrapper: table.table
                tr
                    th.td-narrow Afbeelding
                    th Naam
                    th Aantal
                    th Prijs
                    th Geaccepteerd
                    th
                
                tr(ng-repeat="product in $ctrl.products.data")
                    td.td-narrow: img(
                        ng-src="{{ product.photo ? product.photo.sizes.small : './assets/img/placeholders/product-small.png' }}").td-media
                    td(ng-bind="product.name")
                    td(ng-if="product.unlimited_stock") Ongelimiteerd
                    td(ng-if="!product.unlimited_stock" ng-bind="product.stock_amount")
                    td(ng-bind="product.price_locale")
                    
                    td.td-narrow: .form.pull-right: label(
                        for=("product_{{ product.id }}_enabled") 
                        ng-class="$ctrl.fundProvider.allow_products ? 'form-toggle-disabled form-toggle-active' : ''").form-toggle
                        input(
                            type="checkbox" 
                            id=("product_{{ product.id }}_enabled") 
                            ng-model="product.allowed"
                            ng-change="$ctrl.updateAllowBudgetItem($ctrl.fundProvider, product)")
                        .form-toggle-inner: .toggle-input: .toggle-input-dot
                    td.td-narrow.text-right: .button-group.flex-end
                        a(
                            ng-if="$ctrl.organization.manage_provider_products" 
                            ui-sref="fund-provider-product-create(product.copyParams)").button.button-icon.button-text: em.mdi.mdi-content-copy
                        button(ng-click="$ctrl.openProductDetails(product)").button.button-default.button-sm
                            em.mdi.mdi-eye-outline.icon-start
                            | Kijk
            
            .card-section.text-center(ng-if="$ctrl.products.meta.total == 0") Geen aanbiedingen
            .card-section.card-section-narrow(ng-if="$ctrl.products.meta" ng-show="$ctrl.products.meta.last_page > 1")
                paginator(meta="$ctrl.products.meta" filters="$ctrl.filters.values" count-buttons="5" on-page-change="$ctrl.onPageChange(query)")

        //- Products for subsidy fund
        .card(ng-if="$ctrl.fundProvider.fund.type == 'subsidies'")
            .card-header: .flex-row
                .flex-col: .card-title Aanbiedingen
                .flex-col: .card-header-drown: .block.block-inline-filters
                    .form(ng-if="!$ctrl.filters.show"): .form-group: input(
                        ng-model="$ctrl.filters.values.q"
                        placeholder="Zoeken").form-control
            
            .card-section.card-section-padless: .table-wrapper: table.table
                tr
                    th.td-narrow Afbeelding
                    th Naam
                    th Aantal
                    th Bijdrage
                    th Prijs
                    th
                
                tr(ng-repeat="product in $ctrl.products.data")
                    td.td-narrow: img(ng-src="{{ product.photo ? product.photo.sizes.small : './assets/img/placeholders/product-small.png' }}").td-media
                    td(ng-bind="product.name")
                    td(ng-if="product.unlimited_stock") Ongelimiteerd
                    td(ng-if="!product.unlimited_stock" ng-bind="product.stock_amount")
                    td(ng-bind="product.active_deal ? (product.active_deal.amount | currency_format) : '-'")
                    td(ng-bind="product.price_locale")
                    td.td-narrow.text-right: .button-group.flex-end
                        .button.button-primary.button-sm.nowrap(
                            ng-if="product.is_available && !product.allowed" 
                            ng-click="$ctrl.openSubsidyProductModal($ctrl.fundProvider, product)")
                            em.mdi.mdi-play.icon-start
                            | Start actie
                        div(ng-if="product.is_available && product.allowed")
                            .tag.tag-success.nowrap
                                | Actie actief 
                                .mdi.mdi-close.icon-end(ng-click="$ctrl.disableProductItem($ctrl.fundProvider, product)")
                            .hidden
                        div(ng-if="!product.is_available")
                            .tag.tag-text.nowrap Niet beschikbaar 
                            .hidden
                        a(
                            ng-if="$ctrl.organization.manage_provider_products" 
                            ui-sref="fund-provider-product-create(product.copyParams)").button.button-icon.button-text: em.mdi.mdi-content-copy
                        button(ng-click="$ctrl.openProductDetails(product)").button.button-default.button-sm
                            em.mdi.mdi-eye-outline.icon-start
                            | Bekijken

            .card-section.text-center(ng-if="$ctrl.products.meta.total == 0") Geen aanbiedingen
            .card-section.card-section-narrow(ng-if="$ctrl.products.meta" ng-show="$ctrl.products.meta.last_page > 1")
                paginator(meta="$ctrl.products.meta" filters="$ctrl.filters.values" count-buttons="5" on-page-change="$ctrl.onPageChange(query)")

        //- Provider offices
        block-provider-organization-offices(offices="$ctrl.fundProvider.offices")
        
        //- Provider employees
        block-provider-organization-employees(employees="$ctrl.fundProvider.employees")
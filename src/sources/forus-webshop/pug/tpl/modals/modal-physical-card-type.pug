- var src_prefix = (qdt_c.platform.env_data.html5ModeEnabled?qdt_c.platform.env_data.html5Mode.basePath:'');

.modal.modal-physical-cards.modal-animated(ng-class="[$ctrl.modal.scope.modalClass, $ctrl.modalClass, $ctrl.modal.loaded ? '' : 'modal-loading']")
    .modal-backdrop(ng-click="$ctrl.close()")
    
    //- Select type
    .modal-window(ng-if="$ctrl.state == 'select_type'")
        .modal-close.mdi.mdi-close(ng-click="$ctrl.close()")
        .modal-header
            .modal-title(translate="physical_card.modal_section.type_selection.title")
            .modal-subtitle(translate="physical_card.modal_section.type_selection.subtitle")
        .modal-content: .modal-section: form.form(ng-submit="$ctrl.form.submit()")
            .physical-card: .physical-card-row
                .physical-card-item(ng-click="$ctrl.choosePhysicalCardType('old')")
                    .physical-card-item-title(translate="physical_card.modal_section.type_selection.card_old.title")
                    .physical-card-item-inner
                        .physical-card-item-icon: include ../../../resources/_webshop-common/assets/img/icon-physical-cards/icon-physical-card-code.svg
                    
                    .physical-card-item-details
                        .physical-card-item-title(translate="physical_card.modal_section.type_selection.card_old.title")
                        .physical-card-item-description(translate="physical_card.modal_section.type_selection.card_old.description")
                
                .physical-card-item(ng-click="$ctrl.choosePhysicalCardType('new')")
                    .physical-card-item-title(translate="physical_card.modal_section.type_selection.card_new.title")
                    .physical-card-item-inner
                        .physical-card-item-icon: include ../../../resources/_webshop-common/assets/img/icon-physical-cards/icon-physical-card-envelope.svg
                    
                    .physical-card-item-details
                        .physical-card-item-title(translate="physical_card.modal_section.type_selection.card_new.title")
                        .physical-card-item-description(translate="physical_card.modal_section.type_selection.card_new.description")

    //- Activation code form
    .modal-window(ng-if="$ctrl.state == 'card_code'")
        .modal-close.mdi.mdi-close(ng-click="$ctrl.close()")
        .modal-header
            .modal-title(translate="physical_card.modal_section.link_card.title")
        .modal-content: .modal-section: form.form
            .activation-card
                .physical-card-title(translate="physical_card.modal_section.link_card.subtitle")
                pincode-control(
                    ng-model="$ctrl.activateCodeForm.values.code" 
                    block-size="4" 
                    block-count="3" 
                    block-input-type="num"
                    cant-delete-length="4").block-pincode-compact.block-pincode-mobile-collapse
                .form-error.text-center(ng-repeat="error in $ctrl.activateCodeForm.errors.code" ng-bind="error")

                .physical-card-media: img(src=src_prefix + "./assets/img/icon-physical-cards/icon-physical-cards-preview.svg")
                .physical-card-description(translate="physical_card.modal_section.link_card.description")

                .text-center: button.button.button-dark(
                    ng-class="{disabled: $ctrl.activateCodeForm.values.code.length != 12}"
                    type="button" 
                    i18n="physical_card.buttons.link_card.submit_code" 
                    ng-click="$ctrl.submitActivationCode()")
    
    //- Digital password
    .modal-window(ng-if="$ctrl.state == 'digital_pass'")
        .modal-close.mdi.mdi-close(ng-click="$ctrl.close()")
        .modal-header
            .modal-title(translate="physical_card.modal_section.request_new_card.title")
            .modal-subtitle(translate="physical_card.modal_section.request_new_card.subtitle")
        .modal-content 
            .modal-section(ng-if="!$ctrl.preffersPlasticCard")
                .physical-card: .physical-card-row
                    .physical-card-item.physical-card-item-sm(ng-click="$ctrl.sendVoucherEmail()")
                        .physical-card-item-inner
                            .physical-card-item-title(translate="physical_card.modal_section.request_new_card.email_to_me")
                            .physical-card-item-icon: include ../../../resources/_webshop-common/assets/img/physical-card-email.svg
                        .physical-card-item-details
                            .physical-card-item-title(translate="physical_card.modal_section.request_new_card.email_to_me")
                    
                    .physical-card-item.physical-card-item-sm(ng-click="$ctrl.printQrCode()")
                        .physical-card-item-inner
                            .physical-card-item-title(translate="physical_card.modal_section.request_new_card.print_pass")
                            .physical-card-item-icon: include ../../../resources/_webshop-common/assets/img/physical-card-print.svg
                        .physical-card-item-details
                            .physical-card-item-title(translate="physical_card.modal_section.request_new_card.print_pass")
                    
                    .physical-card-item.physical-card-item-sm(ng-click="$ctrl.openInMeModal()")
                        .physical-card-item-inner
                            .physical-card-item-title(translate="physical_card.modal_section.request_new_card.open_in_app")
                            .physical-card-item-icon: include ../../../resources/_webshop-common/assets/img/physical-card-open-app.svg
                        .physical-card-item-details
                            .physical-card-item-title(translate="physical_card.modal_section.request_new_card.open_in_app")

                .order-block(ng-if="!$ctrl.preffersPlasticCard")
                    .physical-card-description(translate="physical_card.modal_section.request_new_card.preffer_plastic_card")
                    .text-center: button.button.button-dark(
                        type="button" 
                        translate="physical_card.buttons.request_new_card.order_by_email" 
                        ng-click="$ctrl.prefferPlasticCard()")
            
            .modal-section(ng-if="$ctrl.preffersPlasticCard")
                .order-block
                    .physical-card-description(translate="physical_card.modal_section.request_new_card.order")
                    .row: .col.col-sm-8.col-sm-offset-2: form.form
                        .form-group
                            label.form-label(translate="physical_card.modal_section.request_new_card.address")
                            input(
                                id="physical_card_address"
                                placeholder="{{ 'physical_card.modal_section.request_new_card.address_placeholder' | translate }}" 
                                ng-model="$ctrl.requestPhysicalCardForm.values.address").form-control
                            .form-error(ng-repeat="error in $ctrl.requestPhysicalCardForm.errors.address" ng-bind="error")

                        .form-group
                            label.form-label(translate="physical_card.modal_section.request_new_card.house")
                            input(
                                placeholder="{{ 'physical_card.modal_section.request_new_card.house_placeholder' | translate }}" 
                                ng-model="$ctrl.requestPhysicalCardForm.values.house").form-control
                            .form-error(ng-repeat="error in $ctrl.requestPhysicalCardForm.errors.house" ng-bind="error")

                        .form-group
                            label.form-label(translate="physical_card.modal_section.request_new_card.house_addition")
                            input(
                                placeholder="{{ 'physical_card.modal_section.request_new_card.house_addition_placeholder' | translate }}" 
                                ng-model="$ctrl.requestPhysicalCardForm.values.house_addition").form-control
                            .form-error(ng-repeat="error in $ctrl.requestPhysicalCardForm.errors.house_addition" ng-bind="error")

                        .form-group
                            label.form-label(translate="physical_card.modal_section.request_new_card.postcode")
                            input(
                                placeholder="{{ 'physical_card.modal_section.request_new_card.postcode_placeholder' | translate }}" 
                                ng-model="$ctrl.requestPhysicalCardForm.values.postcode").form-control
                            .form-error(ng-repeat="error in $ctrl.requestPhysicalCardForm.errors.postcode" ng-bind="error")

                        .form-group
                            label.form-label(translate="physical_card.modal_section.request_new_card.city")
                            input(
                                placeholder="{{ 'physical_card.modal_section.request_new_card.city_placeholder' | translate }}" 
                                ng-model="$ctrl.requestPhysicalCardForm.values.city").form-control
                            .form-error(ng-repeat="error in $ctrl.requestPhysicalCardForm.errors.city" ng-bind="error")
                            .form-group: .form-error(ng-repeat="error in $ctrl.requestPhysicalCardForm.errors.to_many_requests" ng-bind="error")
                    
                    .physical-card-media.physical-card-media-sm
                        img(src=src_prefix + "./assets/img/icon-physical-cards/icon-physical-cards-preview-variant.png")


                .text-center: button.button.button-dark(type="button" translate="physical_card.buttons.request_new_card.confirm" ng-click="$ctrl.requestCard()")    

    //- Success old card
    .modal-window(ng-if="$ctrl.state == 'success_old_card'")
        .modal-close.mdi.mdi-close(ng-click="$ctrl.close()")
        .modal-header: .modal-title(translate="physical_card.modal_section.link_card_success.title")
        .modal-content: .modal-section
            .physical-card-result
                .physical-card-media: include ../../../resources/_webshop-common/assets/img/icon-physical-cards/icon-physical-cards-success.svg
                .physical-card-description(i18n="physical_card.modal_section.link_card_success.description" i18n-vars="{ fundName: $ctrl.voucher.fund.name }")        
                .text-center: button.button.button-dark(type="button" ng-click="$ctrl.close()" i18n="physical_card.buttons.close")   

    //- Success new card
    .modal-window(ng-if="$ctrl.state == 'success_new_card'")
        .modal-close.mdi.mdi-close(ng-click="$ctrl.close()")
        .modal-header: .modal-title(translate="physical_card.modal_section.request_card_success.title")
        .modal-content: .modal-section
            .physical-card-result
                .physical-card-media: include ../../../resources/_webshop-common/assets/img/icon-physical-cards/icon-physical-cards-success.svg
                .physical-card-description(i18n="physical_card.modal_section.request_card_success.description" i18n-vars="{ fundName: $ctrl.voucher.fund.name }")
                .text-center: button.button.button-dark(type="button" ng-click="$ctrl.close()" i18n="physical_card.buttons.close")